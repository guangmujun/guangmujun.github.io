(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{589:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_12关注者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12关注者"}},[s._v("#")]),s._v(" 12关注者")]),s._v(" "),a("h2",{attrs:{id:"_12-1-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-1-前言"}},[s._v("#")]),s._v(" 12.1 前言")]),s._v(" "),a("blockquote",[a("p",[s._v("项目地址：https://gitee.com/guangmujun/micro-blog 个人网站：https://guangmujun.cn\nFlask Web学习：https://guangmujun.cn/archives/category/learning-note/flask-web\nMySQL学习：https://guangmujun.cn/archives/category/learning-note/mysql-note 参考：")])]),s._v(" "),a("p",[s._v("让用户关注其他用户，并在首页只显示所关注用户发布的文章列表")]),s._v(" "),a("h2",{attrs:{id:"_12-2-数据库关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-2-数据库关系"}},[s._v("#")]),s._v(" 12.2 数据库关系")]),s._v(" "),a("h3",{attrs:{id:"_12-1-1-多对多关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-1-1-多对多关系"}},[s._v("#")]),s._v(" 12.1.1 多对多关系")]),s._v(" "),a("p",[s._v("使用关联表")]),s._v(" "),a("h3",{attrs:{id:"_12-1-2-自引用关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-1-2-自引用关系"}},[s._v("#")]),s._v(" 12.1.2 自引用关系")]),s._v(" "),a("p",[s._v("如果关系中的两侧都在同一个表中，这种关系称为自引用关系。 关联表follows：")]),s._v(" "),a("ul",[a("li",[s._v("每一行表示一个用户关注了另一个用户")]),s._v(" "),a("li",[s._v("followe_id 关注了 followed_id")])]),s._v(" "),a("h3",{attrs:{id:"_12-1-3-高级多对多关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-1-3-高级多对多关系"}},[s._v("#")]),s._v(" 12.1.3 高级多对多关系")]),s._v(" "),a("p",[s._v("存储所连两个实体之间的额外信息。 比如， 存储用户关注另一个用户的日期。 "),a("code",[s._v("app/models.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    class Follow(db.Model):\n​        "),a("strong",[s._v("tablename")]),s._v(" = 'follows'\n​        follower_id = db.Column(db.Integer, db.ForeignKey('users.id'), primary_key=True)  # 关注者的id\n​        followed_id = db.Column(db.Integer, db.ForeignKey('users.id'), primary_key=True)  # 被关注者的id\n​        timestamp = db.Column(db.DateTime, default=datetime.utcnow)                       # 关注的时间")]),s._v(" "),a("p",[s._v("将这个多对多关系的左右两侧拆分成两个基本的一对多关系，而且要定义成标准的关系。 "),a("strong",[s._v("这块有些不大明白！！！！！！！！")]),s._v(" "),a("code",[s._v("app/models.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    class User(UserMixin, db.Model):\n​        "),a("strong",[s._v("tablename")]),s._v(" = 'users'\n​"),a("br"),s._v("\nfollowed = db.relationship('Follow',                                        # 关注的用户\nforeign_keys=[Follow.follower_id],\nbackref=db.backref('follower', lazy='joined'),\nlazy='dynamic',\ncascade='all,delete-orphan')\nfollowers = db.relationship('Follow',                                       # 粉丝\nforeign_keys=[Follow.followed_id],\nbackref=db.backref('followed', lazy='joined'),\nlazy='dynamic',\ncascade='all,delete-orphan')")]),s._v(" "),a("p",[s._v("follower，关注者，我的关注者是关注我的人 followed，被关注者，我的被关注者是我关注的人 "),a("code",[s._v("app/models.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    class User(UserMixin, db.Model):\n​"),a("br"),s._v('\ndef follow(self, user):\n"""\n自己关注某个用户\n:param user:\n:return:\n"""\nif not self.is_following(user):                 # 先看是不是已经关注了，没关注的话\nf = Follow(follower=self, followed=user)    # 自己是关注者，user是被关注者\ndb.session.add(f)')]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('    def unfollow(self, user):\n        """\n        自己取消关注某个用户\n        :param user:\n        :return:\n        """\n        f = self.followed.filter_by(followed_id=user.id).first()  # 看看自己的followed中是否有user\n        if f:\n            db.session.delete(f)                                  # 有的话，删除\n\n    def is_following(self, user):\n        """\n        检查自己是否已经关注了某个用户\n        :param user:\n        :return:\n        """\n        if user.id is None:\n            return False\n        return self.followed.filter_by(followed_id=user.id).first() is not None  # 查询用户id是否在followed_id中\n\n    def is_followed_by(self, user):\n        """\n        检查自己是否已经被某个用户关注\n        :param user:\n        :return:\n        """\n        if user.id is None:\n            return False\n        return self.followers.filter_by(follower_id=user.id).first() is not None  # 看自己的关注者列表中是否有user\n')])])]),a("p",[s._v("​"),a("br"),s._v("\n​")]),s._v(" "),a("h2",{attrs:{id:"_12-3-在资料页面中显示关注者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-3-在资料页面中显示关注者"}},[s._v("#")]),s._v(" 12.3 在资料页面中显示关注者")]),s._v(" "),a("p",[a("code",[s._v("app/tempaltes/user.html")])]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        {% if current_user.can(Permission.FOLLOW) and user != current_user %}\n        {% if not current_user.is_following(user) %}\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("{{ url_for("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(".follow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(", username=user.username) }}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("btn btn-primary"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("关注"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        {% else %}\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("{{ url_for("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(".unfollow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(", username=user.username) }}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("btn btn-default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("取消关注"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        {% endif %}\n        {% endif %}\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("{{ url_for("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(".followers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(", username=user.username) }}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("粉丝： "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("span")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("badge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("{{ user.followers.count() - 1 }}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("span")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("{{ url_for("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(".followed_by"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(", username=user.username) }}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("关注： "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("span")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("badge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("{{ user.followed.count() - 1 }}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("span")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        {% if current_user.is_authenticated and user != current_user and user.is_following(current_user) %}\n        | "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("span")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("label label-default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("关注了你"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("span")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        {% endif %}\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[a("code",[s._v("app/main/views.py")])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/followed_by/<username>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("followed_by")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​        user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("filter_by"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​            flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"无效的用户!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        page "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'page'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        pagination "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("followed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("paginate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n​            page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" per_page"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("current_app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'FLAKSY_POSTS_PER_PAGE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n​            error_out"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        follows "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("followed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'timestamp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" item "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" pagination"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" render_template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'followers.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" title"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"关注"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n​                               endpoint"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.followed_by'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pagination"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pagination"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n​                               follows"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("follows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n​    \n​    @main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/followers/<username>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("followers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​        user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("filter_by"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​            flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"无效的用户!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        page "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'page'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        pagination "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("followers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("paginate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n​            page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" per_page"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("current_app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'FLAKSY_POSTS_PER_PAGE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n​            error_out"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        follows "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("follower"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'timestamp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" item "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" pagination"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" render_template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'followers.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" title"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"粉丝"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n​                               endpoint"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.followers'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pagination"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pagination"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n​                               follows"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("follows"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n​    \n​    @main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/unfollow/<username>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​    @login_required\n​    @permission_required"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Permission"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("FOLLOW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unfollow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​        user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("filter_by"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​            flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"无效的用户!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" current_user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_following"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​            flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"你没有关注此用户！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        current_user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("unfollow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'你取消关注了 {username} !'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n​    \n​    @main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/follow/<username>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​    @login_required\n​    @permission_required"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Permission"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("FOLLOW"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("follow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​        user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("filter_by"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​            flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"无效的用户!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" current_user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_following"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n​            flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"你已关注此用户！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        current_user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("follow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        flash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'你关注了 {username} !'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n​        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url_for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br")])]),a("p",[s._v("效果： "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326203002.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326203019.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326203030.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326203055.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"_12-4-使用数据库联结查询所关注用户的文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-4-使用数据库联结查询所关注用户的文章"}},[s._v("#")]),s._v(" 12.4 使用数据库联结查询所关注用户的文章")]),s._v(" "),a("p",[s._v("添加一个功能：能查看所关注用户发布的文章 基本思路：")]),s._v(" "),a("ul",[a("li",[s._v("获取关注的用户")]),s._v(" "),a("li",[s._v("获取各用户的文章")]),s._v(" "),a("li",[s._v("将文章排序写入一个列表")])]),s._v(" "),a("p",[s._v("存在的问题：")]),s._v(" "),a("ul",[a("li",[s._v("伸缩性不好")]),s._v(" "),a("li",[s._v("数据库的规模变大，则生成这个列表的工作量也不断增加")]),s._v(" "),a("li",[s._v("N+1问题")])]),s._v(" "),a("p",[s._v("优化思路： 一次查询中完成所有操作—— "),a("strong",[s._v("联结")])]),s._v(" "),a("ul",[a("li",[s._v("在两个或多个数据表中，查找满足指定条件的记录组合")]),s._v(" "),a("li",[s._v("再把记录组合插入一个临时表中，这个临时表就是联结查询的二级果")])]),s._v(" "),a("p",[a("code",[s._v("app/models.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    class User(UserMixin, db.Model):\n​"),a("br"),s._v('\n@property\ndef followed_posts(self):\n"""\n获取所关注用户的文章\n:return:\n"""\nreturn Post.query.join(Follow, Follow.followed_id == Post.author_id).filter(Follow.follower_id == self.id)')]),s._v(" "),a("h2",{attrs:{id:"_12-5-在首页示所关注用户的文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-5-在首页示所关注用户的文章"}},[s._v("#")]),s._v(" 12.5 在首页示所关注用户的文章")]),s._v(" "),a("p",[a("code",[s._v("app/main/views.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    @main.route('/', methods=['GET', 'POST'])\n​    def index():\n​        form = PostForm()\n​        if current_user.can(Permission.WRITE_ARTICLES) and form.validate_on_submit():\n​            post = Post(body=form.body.data, author=current_user._get_current_object())  # 真正的用户对象\n​            db.session.add(post)\n​            return redirect(url_for('.index'))\n​        page = request.args.get('page', 1, type=int)                                        # 渲染的页数，默认渲染第一页\n​        show_followed = False\n​        if current_user.is_authenticated:  # show_followed存在cookies中\n​            show_followed = bool(request.cookies.get('show_followed', ''))\n​        if show_followed:\n​            query = current_user.followed_posts  # 是显示关注的用户的文章\n​        else:\n​            query = Post.query                   # 显示所有文章\n​        pagination = query.order_by(Post.timestamp.desc()).paginate(                   # 参数page，页数\n​            page, per_page=current_app.config['FLAKSY_POSTS_PER_PAGE'], error_out=False     # 可选参数per_page每页的记录数\n​        )                                                                                   # 可选参数error_out，False，超出范围返回空列表\n​        posts = pagination.items\n​        return render_template('index.html', form=form, posts=posts, show_followed=show_followed, pagination=pagination)")]),s._v(" "),a("p",[s._v("​")]),s._v(" "),a("p",[s._v("记得s"),a("code",[s._v("how_followed")]),s._v("参数要返传递 "),a("code",[s._v("app/main/views.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    @main.route('/all')\n​    @login_required\n​    def show_all():\n​        resp = make_response(redirect(url_for('.index')))          # 创建响应对象\n​        resp.set_cookie('show_followed', '', max_age=30"),a("em",[s._v("24")]),s._v("60*60)  # 30天\n​        return resp")]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    @main.route('/followed')\n​    @login_required\n​    def show_followed():\n​        resp = make_response(redirect(url_for('.index')))\n​        resp.set_cookie('show_followed', '1', max_age=30"),a("em",[s._v("24")]),s._v("60*60)\n​        return resp")]),s._v(" "),a("p",[a("code",[s._v("app/templates/index.html")])]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v("   "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("post-tabs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("nav nav-tabs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("{%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("show_followed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("%}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("{%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("endif")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("%}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("{{ url_for("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(".show_all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(") }}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("全部"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            {% if current_user.is_authenticated %}\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("{%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("show_followed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("%}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("{%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("endif")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("%}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("{{ url_for("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(".show_followed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v(") }}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("关注"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            {% endif %}\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        {% include '_posts.html' %}\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("出现的问题： 用户无法看到自己发布的文章，因为用户没有关注自己 解决： 创建用户时把用户设为自己的关注者 "),a("code",[s._v("app/models.py")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    class User(UserMixin, db.Model):\n​"),a("br"),s._v("\ndef "),a("strong",[s._v("init")]),s._v("(self, **kwargs):\nsuper(User, self)."),a("strong",[s._v("init")]),s._v("(**kwargs)                                    # 调用基类构造函数\nif self.role is None:\nif self.email == current_app.config['FLASKY_ADMIN']:                # 管理员\nself.role = Role.query.filter_by(permissions=0xff).first()\nif self.role is None:\nself.role = Role.query.filter_by(default=True).first()          # 用户\nif self.email is not None and self.avatar_hash is None:\nself.avatar_hash = hashlib.md5(self.email.encode('utf-8')).hexdigest()\nself.follow(self)")]),s._v(" "),a("p",[s._v("或者直接添加一个实现相同功能的方法 "),a("strong",[s._v("创建函数更新数据库，经常用来更新已部署的应用。")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    @staticmethod\n​    def add_self_follows():  # 用户自己关注自己的方法\n​        for user in User.query.all():\n​            if not user.is_following(user):\n​                user.follow(user)\n​                db.session.add(user)\n​                db.session.commit()")]),s._v(" "),a("p",[s._v("运行：")]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    >>> User.add_self_follows()")]),s._v(" "),a("p",[s._v("修改个人主页的关注和粉丝的数量 "),a("code",[s._v("app/templates/user.html")])]),s._v(" "),a("p",[s._v("​"),a("br"),s._v("\n​    "),a("a",{attrs:{href:"{{ url_for('.followers', username=user.username) }}"}},[s._v("粉丝：\n​        "),a("span",{staticClass:"badge"},[s._v("\n​            "+s._s(s.user.followers.count()-1)+"\n​        ")]),s._v("\n​    ")]),s._v("\n​    "),a("a",{attrs:{href:"{{ url_for('.followed_by', username=user.username) }}"}},[s._v("关注：\n​        "),a("span",{staticClass:"badge"},[s._v("\n​            "+s._s(s.user.followed.count()-1)+"\n​        ")]),s._v("\n​    ")])]),s._v(" "),a("p",[s._v("效果： "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326221238.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326221251.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://my-imags.oss-cn-shanghai.aliyuncs.com/pic/20210326221355.png",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);